<!-- hit me! -->
<% if controller.controller_name == "users" && action_name == "show" && current_user.present? && @user.present? && current_user == @user %>
<div class="text-left">
<button id="tap-to-next-container">

<div id="hit-me-modal" class="fixed inset-0 hidden z-50 bg-black bg-opacity-50 flex items-center justify-center">
 <div class="bg-white rounded-lg shadow-lg w-full sm:w-11/12 max-w-full sm:max-w-6xl p-2 sm:p-6">
  <div class="flashcardContainer m-4 p-3  rounded-2xl duration-200">
   <div id="inputWrapper" class="text-gray-500">


    

      <!-- ã“ã“ã§ã€5ä»¥ä¸‹ã ã£ãŸå ´åˆã®loopã‚‚è¨˜è¿°ã™ã‚‹ã€‚
      5ä»¥ä¸‹ã ã£ãŸå ´åˆã§ã‚‚ã€5ä»¥ä¸Šã ã£ãŸå ´åˆã§ã‚‚ã€åŒã˜å¤‰æ•°ã«æ ¼ç´ã—ã¦ã€ãã‚Œã‚’loopã«è¨˜è¿°ã™ã‚‹ã€‚
      javascriptå´ã§ã¯ã€ãã®å¤‰æ•°ã®.textContentã‚’å–å¾—ã—ã¦ã€ãã‚Œã‚’currentIndexã«è¨­å®šã™ã‚‹ã€‚
      -->

      <!--javascriptã«æ¸¡ã™å€¤-->
      <p id="tapmeLength" class="hidden"><%= @tapmeLength %></p>

      <% if @microposts.present? %>
      <% @microposts.sample(@tapmeLength).each_with_index do |micropost, index| %>

        <div class="hitme-items" style="display: <%= index == 0 ? 'block' : 'none' %>;"> 
        <div class="font-extrabold text-6xl text-blue-500"><%= micropost.content %></div>
        <br>
        <%= micropost.answer %>
        </div>      
      <% end %>
      <% end %>
      <div id="tap-to-next-div" class="text-right"><p id="tap-to-next-value">ğŸš° tap to next ğŸš°</p></div>
    
   </div>
  </div>
 </div>
</div>
</button>
</div>
<% end %>
<!-- hit me! -->


<script>
//hit meã®è¡¨ç¤º
document.addEventListener('DOMContentLoaded', function() {
  const openBtns = document.querySelectorAll('.open-hit-me-modal');
  const modal = document.getElementById('hit-me-modal');

  if (modal) {
    openBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        console.log("clicked");
        modal.classList.remove('hidden');
      });
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.add('hidden');
      }
    });
  }
});

//hit meã®"tap to next"ã®ã‚«ãƒ¼ãƒ‰æ©Ÿèƒ½
document.addEventListener('DOMContentLoaded', function(){
  const tapToNextContainer = document.getElementById('tap-to-next-container')
  const tapToNextDiv = document.getElementById('tap-to-next-div')
  const tapToNextValue = document.getElementById('tap-to-next-value')
  const hitmeItems = document.querySelectorAll('.hitme-items')

  const tapmeLength = document.getElementById('tapmeLength')
  const tapmeLengthValue = tapmeLength.textContent
  console.log("tapmeLengthValue: " + tapmeLengthValue);

  //lengthãŒã‚¼ãƒ­ã ã£ãŸå ´åˆã‚‚ã€‚(ãƒã‚°ã‚ã‚Šã€‚æ©Ÿèƒ½ã—ã¦ã„ãªã„ã€‚)
  if(tapmeLengthValue == ""){
    tapToNextDiv.classList.add('text-center')
    tapToNextDiv.classList.remove('text-right')
    tapToNextValue.classList.add('font-semibold', 'text-6xl', 'text', 'text-center');
    tapToNextValue.textContent = "ã¾ãšã¯ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ç™»éŒ²ã—ã‚ˆã†ï¼"
  }




  let currentIndex = 0;
  
  tapToNextContainer.addEventListener('click', ()=>{
    console.log("tap tap!")

   
    //çµ‚äº†ã—ãŸå ´åˆ
    if(currentIndex == tapmeLengthValue-1){
      tapToNextDiv.classList.add('text-center')
      tapToNextDiv.classList.remove('text-right')
      tapToNextValue.classList.add('font-semibold', 'text-6xl', 'text-black', 'text-center');
      tapToNextValue.textContent = "âœ…done"
      console.log("done")
      location.reload();
    }

    hitmeItems[currentIndex].style.display = 'none';
    hitmeItems[currentIndex+1].style.display = 'block';
    currentIndex++;
  })
  
})
</script>