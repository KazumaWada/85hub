
<!--- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã€status --->

<!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒéƒ¨åˆ†ã¨statuséƒ¨åˆ†ã§å¤§ãã•ãŒç•°ãªã‚‹ã‹ã‚‰ã€gridã§ã¯ãªãflexboxã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ -->
 <div class="flex items-start gap-4 mb-4"> 
 
 <!-- ğŸ™ğŸ»â€â™‚ï¸ profile-pic å¤–æ è–„ã„ç·š -->
  <div class="pl-3">
  <%= image_tag "character.jpg", class: "w-[200px] h-[250px] object-cover border-2 border-gray-200 duration-200 rounded-2xl p-3" %>
  
 </div>

 <!-- ğŸ‘‘ user.nameã¨status å¤–æ è–„ã„ç·š -->
  <!--name, status-->
  <div class="border-2 border-gray-200 rounded-2xl p-5 max-w-sm bg-white">
    <h3 class="text-lg font-semibold text-gray-800 mb-3">
        <%= @user.name %>'s 85Hub Stats ğŸš€
    </h3>

    <div class="">
        
        <div class="text-gray-600 mb-2">
            ğŸ•ï¸ <strong class="ml-1 text-gray-800 font-medium">Joined:</strong> 
            <span class="ml-1"><%= @user.created_at.strftime("%Y-%m") %></span>
        </div>

        <div class="text-gray-600 mb-2">
            <span class="text-xl">ğŸ“Š</span> <strong class="ml-1 text-gray-800 font-medium">Posts:</strong> 
            <span class="ml-1"><%= @posts_count %></span>
        </div>

        <div class="text-gray-600 mb-2">
             <span class="text-xl">ğŸ”—</span> <strong class="ml-1 text-gray-800 font-medium">Links:</strong> 
            <span class="ml-1"><%= @links_count %></span>
        </div>

        <div class="text-gray-600 mb-2">
            <span class="text-xl">â­ï¸</span> <strong class="ml-1 text-gray-800 font-medium">Login stroke:</strong> 
            <span class="ml-1">15 days in a low!</span>
        </div>
    </div>
    
    <hr class="my-3 border-gray-200">

     <p class="text-xs text-gray-500">
         Powered by 85hub Stats âœ¨
     </p>
   </div>



</div>


<!--- å‚è€ƒãƒªãƒ³ã‚¯ --->

<!-- å¤–æ è–„ã„ç·š -->
<div class="p-3 m-0 rounded-none sm:m-2 sm:rounded-2xl border-2 border-gray-200 duration-200">
<!-- TODO: phoneã¯éè¡¨ç¤ºã«ã™ã‚‹ã€€-->
<div class="grid grid-cols-1 md:grid-cols-5 gap-1">
 <!-- TODO: å‹•ç”»ã¯10å€‹ã¾ã§è¡¨ç¤ºã™ã‚‹ã€‚ã€€-->
 <% @microposts.first(5).each do |micropost| %>
  
  <% if micropost.reference_link.present? %>
   
  
  
     <!-- YouTubeã®æ™‚é–“ã®paramsãŒãƒªãƒ³ã‚¯ã«å«ã¾ã‚Œã¦ã„ãŸã‚‰ã†ã¾ãè¡¨ç¤ºã•ã‚Œãªã„ã€‚ã ã‹ã‚‰å«ã¾ã‚Œã¦ã„ãŸã‚‰ã‚«ãƒƒãƒˆ -->
         <% if micropost.reference_link.include?("&t=") %>
         <!--https://docs.ruby-lang.org/ja/latest/method/String/i/sub.html-->
         <% clean_url = micropost.reference_link.sub(/&t=.*/, '') %>
         <%= clean_url %>
         <% end %>

         <!--watchãŒã‚ã‚‹ã¨frameãŒè¡¨ç¤ºã•ã‚Œãªã„ã‹ã‚‰ã€embedã§è¡¨ç¤ºã€‚-->
         <% if micropost.reference_link.start_with?("https://www.youtube.com") %>   
            <% embed_url = micropost.reference_link.gsub("watch?v=", "embed/") %>
            <iframe class="w-full" height="190" src="<%= embed_url %>" 
              title="YouTube video player" frameborder="0" 
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
              allowfullscreen></iframe>
          <% else %>


          <!-- YouTubeä»¥å¤–ã ã£ãŸã‚‰ã€æ™®é€šã«æ–‡å­—åˆ—ã§è¡¨ç¤º -->
          
          <!-- relativeã‚’è¦ªè¦ç´ ã€absoluteã§ãã®ä¸Šã«æµ®ã‹ã›ã‚‹ -->
          <div class="relative">
           
           <div>
            <%= image_tag "default_img.png", class: "h-[190px] w-full" %>
           </div>

           <div class="absolute bottom-0 text-blue-600 mb-2 uppercase font-extrabold">  
            <!--30æ–‡å­—ä»¥ä¸Šã ã£ãŸã‚‰åˆ‡ã£ã¦ã€https://ã‚‚åˆ‡ã‚‹ã€‚-->
            <% formatted_link =
            micropost.reference_link
            .to_s
            # httpã¨httpsã‚’s?ã§ã©ã¡ã‚‰ã‚‚å¯¾å¿œã€‚
            #//ã‚’\ã§æ–‡å­—åˆ—ã«ã€‚æœ€å¾Œã®\ã¯æ­£è¦è¡¨ç¾ã‚’é–‰ã˜ã‚‹ã€‚
            .sub(/^https?:\/\//, "")
            .truncate(20)
            %>
            ğŸ”— <a href="<%= micropost.reference_link %>" target="_blank" class="underline hover:text-blue-800">
                <%= formatted_link %>
              </a>
           </div>
          </div><!-- relative -->
          
          <% end %>
  <% end %>

 <% end %>
</div>
</div>

